<h2><%=h @question.name %></h2>
<div class="question">
  <div class="body">
    <%=h @question.body %>
    <span class="user"><%= @question.user.login %><br /><%= distance_of_time_in_words_to_now @question.created_at %> ago</span>
  </div>

<div class="tags">
  <%@question.tags.each do |tag| %>
   <%= link_to(h(tag), :controller => "questions", :action => "index", :tag => tag.name)%>
  <% end -%>
<br class="clear" />
</div>
<%= link_to 'Edit', edit_question_path(@question) %>
</div>
<% if @question.answers.length > 0 %>
  <br class="clear" />
  <h2>Answers</h2>
  <% @question.answers.each do |answer| -%>
    <% if answer.id.present? %>
      <div class="answer-item">
        <%= render :partial => "answer", :locals => {:answer => answer}%>
      </div>
      <br class="clear" />
    <% end -%>
  <% end -%>
<% end -%>

<% if (current_user.present? && !@question.answered?(current_user)) %>

  <% form_for(@question, :html => {:class => "form"}) do |f| %>
  <%= f.error_messages %>
  <%  f.fields_for "answers_attributes[]", Answer.new do |a| %>
  <%= a.hidden_field :user_id, :value => current_user.id %>
  
    <%= f.label :body, "My answer:", :class => "label" %>
    <%= a.text_area :body, :class => 'text_area answer' %>
  
  <% end -%>
  <div class="group navform">
    <%= f.submit 'Save', :class => "awesome green" %>
  </div>

  <% end -%>
  <% end %>
  <% content_for :sidebar, render(:partial => "show_sidebar") %>
